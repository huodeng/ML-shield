import{K as le,ai as kt,S as ut,e as ct,aj as Ie,v as u,d as Y,y as T,ak as Ae,al as qe,am as Rt,I as He,L as ge,an as Ct,$ as _t,J as _,P as We,a3 as Re,ao as St,x as Ge,D as K,ap as Tt,U as A,E as ee,aq as Ue,r as $,ar as ft,as as Pt,H as $t,at as M,au as Oe,av as Lt,a1 as Be,aw as zt,b as mt,O as me,ax as Ke,ay as Ne,az as Ot,W as Bt,aA as gt,aB as Ft,aC as Je,a5 as se,B as J,a2 as It,aD as jt,R as Ut,G as Dt,aE as Mt,F as Fe,aF as At,aG as Nt,aH as Et,aI as Vt,a4 as Ye,c as te,a as y,o as V,g as p,aa as ve,u as c,w as h,j as re,p as de,t as W,_ as Xe,a9 as we,aJ as qt,h as xe,k as q,ag as Ht,f as Ee,n as De,ab as ze,aK as Wt,aL as Gt,s as he,a8 as Xt,ae as Qe,af as Ze,aM as Kt,aN as Jt,aO as Yt,aP as $e,A as Qt,l as Zt}from"./index-Bxc172j1.js";import{a as en,N as tn,b as nn}from"./index-BfFqGZ_4.js";import{u as pt,W as et}from"./WarningOutline-XiXWwWXD.js";import{N as an,D as rn,d as ln,a as on}from"./Image-C7_q_JdY.js";import{A as sn}from"./Add-Dci-peTu.js";import{N as dn,a as un}from"./Switch-DieBRdTp.js";import{S as cn}from"./SearchOutline-DGiSeQv6.js";import{S as fn}from"./ShieldCheckmarkOutline-CNq_kuPr.js";import{N as Me,a as mn}from"./Thing-adimtSut.js";import"./utils-DaFc0M5i.js";import"./Checkmark-jiQ0kBN6.js";function gn(e,t,a){var n;const s=le(e,null);if(s===null)return;const l=(n=kt())===null||n===void 0?void 0:n.proxy;ut(a,i),i(a.value),ct(()=>{i(void 0,a.value)});function i(o,r){if(!s)return;const g=s[t];r!==void 0&&m(g,r),o!==void 0&&d(g,o)}function m(o,r){o[r]||(o[r]=[]),o[r].splice(o[r].findIndex(g=>g===l),1)}function d(o,r){o[r]||(o[r]=[]),~o[r].findIndex(g=>g===l)||o[r].push(l)}}const pn=Ie("attach",()=>u("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},u("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},u("g",{fill:"currentColor","fill-rule":"nonzero"},u("path",{d:"M3.25735931,8.70710678 L7.85355339,4.1109127 C8.82986412,3.13460197 10.4127766,3.13460197 11.3890873,4.1109127 C12.365398,5.08722343 12.365398,6.67013588 11.3890873,7.64644661 L6.08578644,12.9497475 C5.69526215,13.3402718 5.06209717,13.3402718 4.67157288,12.9497475 C4.28104858,12.5592232 4.28104858,11.9260582 4.67157288,11.5355339 L9.97487373,6.23223305 C10.1701359,6.0369709 10.1701359,5.72038841 9.97487373,5.52512627 C9.77961159,5.32986412 9.4630291,5.32986412 9.26776695,5.52512627 L3.96446609,10.8284271 C3.18341751,11.6094757 3.18341751,12.8758057 3.96446609,13.6568542 C4.74551468,14.4379028 6.01184464,14.4379028 6.79289322,13.6568542 L12.0961941,8.35355339 C13.4630291,6.98671837 13.4630291,4.77064094 12.0961941,3.40380592 C10.7293591,2.0369709 8.51328163,2.0369709 7.14644661,3.40380592 L2.55025253,8 C2.35499039,8.19526215 2.35499039,8.51184464 2.55025253,8.70710678 C2.74551468,8.90236893 3.06209717,8.90236893 3.25735931,8.70710678 Z"}))))),hn=Ie("cancel",()=>u("svg",{viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},u("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},u("g",{fill:"currentColor","fill-rule":"nonzero"},u("path",{d:"M2.58859116,2.7156945 L2.64644661,2.64644661 C2.82001296,2.47288026 3.08943736,2.45359511 3.2843055,2.58859116 L3.35355339,2.64644661 L8,7.293 L12.6464466,2.64644661 C12.8417088,2.45118446 13.1582912,2.45118446 13.3535534,2.64644661 C13.5488155,2.84170876 13.5488155,3.15829124 13.3535534,3.35355339 L8.707,8 L13.3535534,12.6464466 C13.5271197,12.820013 13.5464049,13.0894374 13.4114088,13.2843055 L13.3535534,13.3535534 C13.179987,13.5271197 12.9105626,13.5464049 12.7156945,13.4114088 L12.6464466,13.3535534 L8,8.707 L3.35355339,13.3535534 C3.15829124,13.5488155 2.84170876,13.5488155 2.64644661,13.3535534 C2.45118446,13.1582912 2.45118446,12.8417088 2.64644661,12.6464466 L7.293,8 L2.64644661,3.35355339 C2.47288026,3.17998704 2.45359511,2.91056264 2.58859116,2.7156945 L2.64644661,2.64644661 L2.58859116,2.7156945 Z"}))))),vn=Y({name:"Eye",render(){return u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u("path",{d:"M255.66 112c-77.94 0-157.89 45.11-220.83 135.33a16 16 0 0 0-.27 17.77C82.92 340.8 161.8 400 255.66 400c92.84 0 173.34-59.38 221.79-135.25a16.14 16.14 0 0 0 0-17.47C428.89 172.28 347.8 112 255.66 112z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"}),u("circle",{cx:"256",cy:"256",r:"80",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"}))}}),bn=Ie("retry",()=>u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u("path",{d:"M320,146s24.36-12-64-12A160,160,0,1,0,416,294",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-miterlimit: 10; stroke-width: 32px;"}),u("polyline",{points:"256 58 336 138 256 218",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),yn=Ie("trash",()=>u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},u("path",{d:"M432,144,403.33,419.74A32,32,0,0,1,371.55,448H140.46a32,32,0,0,1-31.78-28.26L80,144",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),u("rect",{x:"32",y:"64",width:"448",height:"80",rx:"16",ry:"16",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),u("line",{x1:"312",y1:"240",x2:"200",y2:"352",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}),u("line",{x1:"312",y1:"352",x2:"200",y2:"240",style:"fill: none; stroke: currentcolor; stroke-linecap: round; stroke-linejoin: round; stroke-width: 32px;"}))),wn=T("collapse-transition",{width:"100%"},[Ae()]),xn=Object.assign(Object.assign({},ge.props),{show:{type:Boolean,default:!0},appear:Boolean,collapsed:{type:Boolean,default:void 0}}),tt=Y({name:"CollapseTransition",props:xn,inheritAttrs:!1,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:a,mergedRtlRef:n}=He(e),s=ge("CollapseTransition","-collapse-transition",wn,Ct,e,t),l=_t("CollapseTransition",n,t),i=_(()=>e.collapsed!==void 0?e.collapsed:e.show),m=_(()=>{const{self:{bezier:o}}=s.value;return{"--n-bezier":o}}),d=a?We("collapse-transition",void 0,m,e):void 0;return{rtlEnabled:l,mergedShow:i,mergedClsPrefix:t,cssVars:a?void 0:m,themeClass:d==null?void 0:d.themeClass,onRender:d==null?void 0:d.onRender}},render(){return u(qe,{appear:this.appear},{default:()=>{var e;if(this.mergedShow)return(e=this.onRender)===null||e===void 0||e.call(this),u("div",Rt({class:[`${this.mergedClsPrefix}-collapse-transition`,this.rtlEnabled&&`${this.mergedClsPrefix}-collapse-transition--rtl`,this.themeClass],style:this.cssVars},this.$attrs),this.$slots)}})}});function kn(){const e=le(St,null);return e===null&&Re("use-dialog","No outer <n-dialog-provider /> founded."),e}const je=Ge("n-form"),Rn=Ge("n-form-item-insts"),{cubicBezierEaseInOut:nt}=Tt;function Cn({name:e="fade-down",fromOffset:t="-4px",enterDuration:a=".3s",leaveDuration:n=".3s",enterCubicBezier:s=nt,leaveCubicBezier:l=nt}={}){return[K(`&.${e}-transition-enter-from, &.${e}-transition-leave-to`,{opacity:0,transform:`translateY(${t})`}),K(`&.${e}-transition-enter-to, &.${e}-transition-leave-from`,{opacity:1,transform:"translateY(0)"}),K(`&.${e}-transition-leave-active`,{transition:`opacity ${n} ${l}, transform ${n} ${l}`}),K(`&.${e}-transition-enter-active`,{transition:`opacity ${a} ${s}, transform ${a} ${s}`})]}const _n=T("form-item",`
 display: grid;
 line-height: var(--n-line-height);
`,[T("form-item-label",`
 grid-area: label;
 align-items: center;
 line-height: 1.25;
 text-align: var(--n-label-text-align);
 font-size: var(--n-label-font-size);
 min-height: var(--n-label-height);
 padding: var(--n-label-padding);
 color: var(--n-label-text-color);
 transition: color .3s var(--n-bezier);
 box-sizing: border-box;
 font-weight: var(--n-label-font-weight);
 `,[ee("asterisk",`
 white-space: nowrap;
 user-select: none;
 -webkit-user-select: none;
 color: var(--n-asterisk-color);
 transition: color .3s var(--n-bezier);
 `),ee("asterisk-placeholder",`
 grid-area: mark;
 user-select: none;
 -webkit-user-select: none;
 visibility: hidden; 
 `)]),T("form-item-blank",`
 grid-area: blank;
 min-height: var(--n-blank-height);
 `),A("auto-label-width",[T("form-item-label","white-space: nowrap;")]),A("left-labelled",`
 grid-template-areas:
 "label blank"
 "label feedback";
 grid-template-columns: auto minmax(0, 1fr);
 grid-template-rows: auto 1fr;
 align-items: flex-start;
 `,[T("form-item-label",`
 display: grid;
 grid-template-columns: 1fr auto;
 min-height: var(--n-blank-height);
 height: auto;
 box-sizing: border-box;
 flex-shrink: 0;
 flex-grow: 0;
 `,[A("reverse-columns-space",`
 grid-template-columns: auto 1fr;
 `),A("left-mark",`
 grid-template-areas:
 "mark text"
 ". text";
 `),A("right-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),A("right-hanging-mark",`
 grid-template-areas: 
 "text mark"
 "text .";
 `),ee("text",`
 grid-area: text; 
 `),ee("asterisk",`
 grid-area: mark; 
 align-self: end;
 `)])]),A("top-labelled",`
 grid-template-areas:
 "label"
 "blank"
 "feedback";
 grid-template-rows: minmax(var(--n-label-height), auto) 1fr;
 grid-template-columns: minmax(0, 100%);
 `,[A("no-label",`
 grid-template-areas:
 "blank"
 "feedback";
 grid-template-rows: 1fr;
 `),T("form-item-label",`
 display: flex;
 align-items: flex-start;
 justify-content: var(--n-label-text-align);
 `)]),T("form-item-blank",`
 box-sizing: border-box;
 display: flex;
 align-items: center;
 position: relative;
 `),T("form-item-feedback-wrapper",`
 grid-area: feedback;
 box-sizing: border-box;
 min-height: var(--n-feedback-height);
 font-size: var(--n-feedback-font-size);
 line-height: 1.25;
 transform-origin: top left;
 `,[K("&:not(:empty)",`
 padding: var(--n-feedback-padding);
 `),T("form-item-feedback",{transition:"color .3s var(--n-bezier)",color:"var(--n-feedback-text-color)"},[A("warning",{color:"var(--n-feedback-text-color-warning)"}),A("error",{color:"var(--n-feedback-text-color-error)"}),Cn({fromOffset:"-3px",enterDuration:".3s",leaveDuration:".2s"})])])]);function Sn(e){const t=le(je,null);return{mergedSize:_(()=>e.size!==void 0?e.size:(t==null?void 0:t.props.size)!==void 0?t.props.size:"medium")}}function Tn(e){const t=le(je,null),a=_(()=>{const{labelPlacement:b}=e;return b!==void 0?b:t!=null&&t.props.labelPlacement?t.props.labelPlacement:"top"}),n=_(()=>a.value==="left"&&(e.labelWidth==="auto"||(t==null?void 0:t.props.labelWidth)==="auto")),s=_(()=>{if(a.value==="top")return;const{labelWidth:b}=e;if(b!==void 0&&b!=="auto")return Ue(b);if(n.value){const R=t==null?void 0:t.maxChildLabelWidthRef.value;return R!==void 0?Ue(R):void 0}if((t==null?void 0:t.props.labelWidth)!==void 0)return Ue(t.props.labelWidth)}),l=_(()=>{const{labelAlign:b}=e;if(b)return b;if(t!=null&&t.props.labelAlign)return t.props.labelAlign}),i=_(()=>{var b;return[(b=e.labelProps)===null||b===void 0?void 0:b.style,e.labelStyle,{width:s.value}]}),m=_(()=>{const{showRequireMark:b}=e;return b!==void 0?b:t==null?void 0:t.props.showRequireMark}),d=_(()=>{const{requireMarkPlacement:b}=e;return b!==void 0?b:(t==null?void 0:t.props.requireMarkPlacement)||"right"}),o=$(!1),r=$(!1),g=_(()=>{const{validationStatus:b}=e;if(b!==void 0)return b;if(o.value)return"error";if(r.value)return"warning"}),S=_(()=>{const{showFeedback:b}=e;return b!==void 0?b:(t==null?void 0:t.props.showFeedback)!==void 0?t.props.showFeedback:!0}),F=_(()=>{const{showLabel:b}=e;return b!==void 0?b:(t==null?void 0:t.props.showLabel)!==void 0?t.props.showLabel:!0});return{validationErrored:o,validationWarned:r,mergedLabelStyle:i,mergedLabelPlacement:a,mergedLabelAlign:l,mergedShowRequireMark:m,mergedRequireMarkPlacement:d,mergedValidationStatus:g,mergedShowFeedback:S,mergedShowLabel:F,isAutoLabelWidth:n}}function Pn(e){const t=le(je,null),a=_(()=>{const{rulePath:i}=e;if(i!==void 0)return i;const{path:m}=e;if(m!==void 0)return m}),n=_(()=>{const i=[],{rule:m}=e;if(m!==void 0&&(Array.isArray(m)?i.push(...m):i.push(m)),t){const{rules:d}=t.props,{value:o}=a;if(d!==void 0&&o!==void 0){const r=ft(d,o);r!==void 0&&(Array.isArray(r)?i.push(...r):i.push(r))}}return i}),s=_(()=>n.value.some(i=>i.required)),l=_(()=>s.value||e.required);return{mergedRules:n,mergedRequired:l}}var at=function(e,t,a,n){function s(l){return l instanceof a?l:new a(function(i){i(l)})}return new(a||(a=Promise))(function(l,i){function m(r){try{o(n.next(r))}catch(g){i(g)}}function d(r){try{o(n.throw(r))}catch(g){i(g)}}function o(r){r.done?l(r.value):s(r.value).then(m,d)}o((n=n.apply(e,t||[])).next())})};const $n=Object.assign(Object.assign({},ge.props),{label:String,labelWidth:[Number,String],labelStyle:[String,Object],labelAlign:String,labelPlacement:String,path:String,first:Boolean,rulePath:String,required:Boolean,showRequireMark:{type:Boolean,default:void 0},requireMarkPlacement:String,showFeedback:{type:Boolean,default:void 0},rule:[Object,Array],size:String,ignorePathChange:Boolean,validationStatus:String,feedback:String,feedbackClass:String,feedbackStyle:[String,Object],showLabel:{type:Boolean,default:void 0},labelProps:Object});function rt(e,t){return(...a)=>{try{const n=e(...a);return!t&&(typeof n=="boolean"||n instanceof Error||Array.isArray(n))||n!=null&&n.then?n:(n===void 0||Ne("form-item/validate",`You return a ${typeof n} typed value in the validator method, which is not recommended. Please use ${t?"`Promise`":"`boolean`, `Error` or `Promise`"} typed value instead.`),!0)}catch(n){Ne("form-item/validate","An error is catched in the validation, so the validation won't be done. Your callback in `validate` method of `n-form` or `n-form-item` won't be called in this validation."),console.error(n);return}}}const Ln=Y({name:"FormItem",props:$n,setup(e){gn(Rn,"formItems",M(e,"path"));const{mergedClsPrefixRef:t,inlineThemeDisabled:a}=He(e),n=le(je,null),s=Sn(e),l=Tn(e),{validationErrored:i,validationWarned:m}=l,{mergedRequired:d,mergedRules:o}=Pn(e),{mergedSize:r}=s,{mergedLabelPlacement:g,mergedLabelAlign:S,mergedRequireMarkPlacement:F}=l,b=$([]),R=$(Oe()),v=n?M(n.props,"disabled"):$(!1),P=ge("Form","-form-item",_n,Lt,e,t);ut(M(e,"path"),()=>{e.ignorePathChange||k()});function k(){b.value=[],i.value=!1,m.value=!1,e.feedback&&(R.value=Oe())}const D=(...C)=>at(this,[...C],void 0,function*(I=null,B=()=>!0,j={suppressWarning:!0}){const{path:X}=e;j?j.first||(j.first=e.first):j={};const{value:Q}=o,ue=n?ft(n.props.model,X||""):void 0,ce={},fe={},ie=(I?Q.filter(U=>Array.isArray(U.trigger)?U.trigger.includes(I):U.trigger===I):Q).filter(B).map((U,Z)=>{const E=Object.assign({},U);if(E.validator&&(E.validator=rt(E.validator,!1)),E.asyncValidator&&(E.asyncValidator=rt(E.asyncValidator,!0)),E.renderMessage){const Pe=`__renderMessage__${Z}`;fe[Pe]=E.message,E.message=Pe,ce[Pe]=E.renderMessage}return E}),oe=ie.filter(U=>U.level!=="warning"),Ce=ie.filter(U=>U.level==="warning"),ae={valid:!0,errors:void 0,warnings:void 0};if(!ie.length)return ae;const pe=X??"__n_no_path__",_e=new Ke({[pe]:oe}),Se=new Ke({[pe]:Ce}),{validateMessages:ye}=(n==null?void 0:n.props)||{};ye&&(_e.messages(ye),Se.messages(ye));const Te=U=>{b.value=U.map(Z=>{const E=(Z==null?void 0:Z.message)||"";return{key:E,render:()=>E.startsWith("__renderMessage__")?ce[E]():E}}),U.forEach(Z=>{var E;!((E=Z.message)===null||E===void 0)&&E.startsWith("__renderMessage__")&&(Z.message=fe[Z.message])})};if(oe.length){const U=yield new Promise(Z=>{_e.validate({[pe]:ue},j,Z)});U!=null&&U.length&&(ae.valid=!1,ae.errors=U,Te(U))}if(Ce.length&&!ae.errors){const U=yield new Promise(Z=>{Se.validate({[pe]:ue},j,Z)});U!=null&&U.length&&(Te(U),ae.warnings=U)}return!ae.errors&&!ae.warnings?k():(i.value=!!ae.errors,m.value=!!ae.warnings),ae});function H(){D("blur")}function x(){D("change")}function z(){D("focus")}function L(){D("input")}function ne(C,I){return at(this,void 0,void 0,function*(){let B,j,X,Q;return typeof C=="string"?(B=C,j=I):C!==null&&typeof C=="object"&&(B=C.trigger,j=C.callback,X=C.shouldRuleBeApplied,Q=C.options),yield new Promise((ue,ce)=>{D(B,X,Q).then(({valid:fe,errors:ie,warnings:oe})=>{fe?(j&&j(void 0,{warnings:oe}),ue({warnings:oe})):(j&&j(ie,{warnings:oe}),ce(ie))})})})}Be(zt,{path:M(e,"path"),disabled:v,mergedSize:s.mergedSize,mergedValidationStatus:l.mergedValidationStatus,restoreValidation:k,handleContentBlur:H,handleContentChange:x,handleContentFocus:z,handleContentInput:L});const f={validate:ne,restoreValidation:k,internalValidate:D},w=$(null);mt(()=>{if(!l.isAutoLabelWidth.value)return;const C=w.value;if(C!==null){const I=C.style.whiteSpace;C.style.whiteSpace="nowrap",C.style.width="",n==null||n.deriveMaxChildLabelWidth(Number(getComputedStyle(C).width.slice(0,-2))),C.style.whiteSpace=I}});const O=_(()=>{var C;const{value:I}=r,{value:B}=g,j=B==="top"?"vertical":"horizontal",{common:{cubicBezierEaseInOut:X},self:{labelTextColor:Q,asteriskColor:ue,lineHeight:ce,feedbackTextColor:fe,feedbackTextColorWarning:ie,feedbackTextColorError:oe,feedbackPadding:Ce,labelFontWeight:ae,[me("labelHeight",I)]:pe,[me("blankHeight",I)]:_e,[me("feedbackFontSize",I)]:Se,[me("feedbackHeight",I)]:ye,[me("labelPadding",j)]:Te,[me("labelTextAlign",j)]:U,[me(me("labelFontSize",B),I)]:Z}}=P.value;let E=(C=S.value)!==null&&C!==void 0?C:U;return B==="top"&&(E=E==="right"?"flex-end":"flex-start"),{"--n-bezier":X,"--n-line-height":ce,"--n-blank-height":_e,"--n-label-font-size":Z,"--n-label-text-align":E,"--n-label-height":pe,"--n-label-padding":Te,"--n-label-font-weight":ae,"--n-asterisk-color":ue,"--n-label-text-color":Q,"--n-feedback-padding":Ce,"--n-feedback-font-size":Se,"--n-feedback-height":ye,"--n-feedback-text-color":fe,"--n-feedback-text-color-warning":ie,"--n-feedback-text-color-error":oe}}),N=a?We("form-item",_(()=>{var C;return`${r.value[0]}${g.value[0]}${((C=S.value)===null||C===void 0?void 0:C[0])||""}`}),O,e):void 0,G=_(()=>g.value==="left"&&F.value==="left"&&S.value==="left");return Object.assign(Object.assign(Object.assign(Object.assign({labelElementRef:w,mergedClsPrefix:t,mergedRequired:d,feedbackId:R,renderExplains:b,reverseColSpace:G},l),s),f),{cssVars:a?void 0:O,themeClass:N==null?void 0:N.themeClass,onRender:N==null?void 0:N.onRender})},render(){const{$slots:e,mergedClsPrefix:t,mergedShowLabel:a,mergedShowRequireMark:n,mergedRequireMarkPlacement:s,onRender:l}=this,i=n!==void 0?n:this.mergedRequired;l==null||l();const m=()=>{const d=this.$slots.label?this.$slots.label():this.label;if(!d)return null;const o=u("span",{class:`${t}-form-item-label__text`},d),r=i?u("span",{class:`${t}-form-item-label__asterisk`},s!=="left"?" *":"* "):s==="right-hanging"&&u("span",{class:`${t}-form-item-label__asterisk-placeholder`}," *"),{labelProps:g}=this;return u("label",Object.assign({},g,{class:[g==null?void 0:g.class,`${t}-form-item-label`,`${t}-form-item-label--${s}-mark`,this.reverseColSpace&&`${t}-form-item-label--reverse-columns-space`],style:this.mergedLabelStyle,ref:"labelElementRef"}),s==="left"?[r,o]:[o,r])};return u("div",{class:[`${t}-form-item`,this.themeClass,`${t}-form-item--${this.mergedSize}-size`,`${t}-form-item--${this.mergedLabelPlacement}-labelled`,this.isAutoLabelWidth&&`${t}-form-item--auto-label-width`,!a&&`${t}-form-item--no-label`],style:this.cssVars},a&&m(),u("div",{class:[`${t}-form-item-blank`,this.mergedValidationStatus&&`${t}-form-item-blank--${this.mergedValidationStatus}`]},e),this.mergedShowFeedback?u("div",{key:this.feedbackId,style:this.feedbackStyle,class:[`${t}-form-item-feedback-wrapper`,this.feedbackClass]},u(Pt,{name:"fade-down-transition",mode:"out-in"},{default:()=>{const{mergedValidationStatus:d}=this;return $t(e.feedback,o=>{var r;const{feedback:g}=this,S=o||g?u("div",{key:"__feedback__",class:`${t}-form-item-feedback__line`},o||g):this.renderExplains.length?(r=this.renderExplains)===null||r===void 0?void 0:r.map(({key:F,render:b})=>u("div",{key:F,class:`${t}-form-item-feedback__line`},b())):null;return S?d==="warning"?u("div",{key:"controlled-warning",class:`${t}-form-item-feedback ${t}-form-item-feedback--warning`},S):d==="error"?u("div",{key:"controlled-error",class:`${t}-form-item-feedback ${t}-form-item-feedback--error`},S):d==="success"?u("div",{key:"controlled-success",class:`${t}-form-item-feedback ${t}-form-item-feedback--success`},S):u("div",{key:"controlled-default",class:`${t}-form-item-feedback`},S):null})}})):null)}}),zn=Object.assign(Object.assign({},ge.props),{trigger:String,xScrollable:Boolean,onScroll:Function,contentClass:String,contentStyle:[Object,String],size:Number,yPlacement:{type:String,default:"right"},xPlacement:{type:String,default:"bottom"}}),On=Y({name:"Scrollbar",props:zn,setup(){const e=$(null);return Object.assign(Object.assign({},{scrollTo:(...a)=>{var n;(n=e.value)===null||n===void 0||n.scrollTo(a[0],a[1])},scrollBy:(...a)=>{var n;(n=e.value)===null||n===void 0||n.scrollBy(a[0],a[1])}}),{scrollbarInstRef:e})},render(){return u(Ot,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),be=Ge("n-upload"),Bn=K([T("upload","width: 100%;",[A("dragger-inside",[T("upload-trigger",`
 display: block;
 `)]),A("drag-over",[T("upload-dragger",`
 border: var(--n-dragger-border-hover);
 `)])]),T("upload-dragger",`
 cursor: pointer;
 box-sizing: border-box;
 width: 100%;
 text-align: center;
 border-radius: var(--n-border-radius);
 padding: 24px;
 opacity: 1;
 transition:
 opacity .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-dragger-color);
 border: var(--n-dragger-border);
 `,[K("&:hover",`
 border: var(--n-dragger-border-hover);
 `),A("disabled",`
 cursor: not-allowed;
 `)]),T("upload-trigger",`
 display: inline-block;
 box-sizing: border-box;
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[K("+",[T("upload-file-list","margin-top: 8px;")]),A("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `),A("image-card",`
 width: 96px;
 height: 96px;
 `,[T("base-icon",`
 font-size: 24px;
 `),T("upload-dragger",`
 padding: 0;
 height: 100%;
 width: 100%;
 display: flex;
 align-items: center;
 justify-content: center;
 `)])]),T("upload-file-list",`
 line-height: var(--n-line-height);
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 `,[K("a, img","outline: none;"),A("disabled",`
 opacity: var(--n-item-disabled-opacity);
 cursor: not-allowed;
 `,[T("upload-file","cursor: not-allowed;")]),A("grid",`
 display: grid;
 grid-template-columns: repeat(auto-fill, 96px);
 grid-gap: 8px;
 margin-top: 0;
 `),T("upload-file",`
 display: block;
 box-sizing: border-box;
 cursor: default;
 padding: 0px 12px 0 6px;
 transition: background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 `,[Ae(),T("progress",[Ae({foldPadding:!0})]),K("&:hover",`
 background-color: var(--n-item-color-hover);
 `,[T("upload-file-info",[ee("action",`
 opacity: 1;
 `)])]),A("image-type",`
 border-radius: var(--n-border-radius);
 text-decoration: underline;
 text-decoration-color: #0000;
 `,[T("upload-file-info",`
 padding-top: 0px;
 padding-bottom: 0px;
 width: 100%;
 height: 100%;
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 6px 0;
 `,[T("progress",`
 padding: 2px 0;
 margin-bottom: 0;
 `),ee("name",`
 padding: 0 8px;
 `),ee("thumbnail",`
 width: 32px;
 height: 32px;
 font-size: 28px;
 display: flex;
 justify-content: center;
 align-items: center;
 `,[K("img",`
 width: 100%;
 `)])])]),A("text-type",[T("progress",`
 box-sizing: border-box;
 padding-bottom: 6px;
 margin-bottom: 6px;
 `)]),A("image-card-type",`
 position: relative;
 width: 96px;
 height: 96px;
 border: var(--n-item-border-image-card);
 border-radius: var(--n-border-radius);
 padding: 0;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: border-color .3s var(--n-bezier), background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 overflow: hidden;
 `,[T("progress",`
 position: absolute;
 left: 8px;
 bottom: 8px;
 right: 8px;
 width: unset;
 `),T("upload-file-info",`
 padding: 0;
 width: 100%;
 height: 100%;
 `,[ee("thumbnail",`
 width: 100%;
 height: 100%;
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 font-size: 36px;
 `,[K("img",`
 width: 100%;
 `)])]),K("&::before",`
 position: absolute;
 z-index: 1;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 opacity: 0;
 transition: opacity .2s var(--n-bezier);
 content: "";
 `),K("&:hover",[K("&::before","opacity: 1;"),T("upload-file-info",[ee("thumbnail","opacity: .12;")])])]),A("error-status",[K("&:hover",`
 background-color: var(--n-item-color-hover-error);
 `),T("upload-file-info",[ee("name","color: var(--n-item-text-color-error);"),ee("thumbnail","color: var(--n-item-text-color-error);")]),A("image-card-type",`
 border: var(--n-item-border-image-card-error);
 `)]),A("with-url",`
 cursor: pointer;
 `,[T("upload-file-info",[ee("name",`
 color: var(--n-item-text-color-success);
 text-decoration-color: var(--n-item-text-color-success);
 `,[K("a",`
 text-decoration: underline;
 `)])])]),T("upload-file-info",`
 position: relative;
 padding-top: 6px;
 padding-bottom: 6px;
 display: flex;
 flex-wrap: nowrap;
 `,[ee("thumbnail",`
 font-size: 18px;
 opacity: 1;
 transition: opacity .2s var(--n-bezier);
 color: var(--n-item-icon-color);
 `,[T("base-icon",`
 margin-right: 2px;
 vertical-align: middle;
 transition: color .3s var(--n-bezier);
 `)]),ee("action",`
 padding-top: inherit;
 padding-bottom: inherit;
 position: absolute;
 right: 0;
 top: 0;
 bottom: 0;
 width: 80px;
 display: flex;
 align-items: center;
 transition: opacity .2s var(--n-bezier);
 justify-content: flex-end;
 opacity: 0;
 `,[T("button",[K("&:not(:last-child)",{marginRight:"4px"}),T("base-icon",[K("svg",[Bt()])])]),A("image-type",`
 position: relative;
 max-width: 80px;
 width: auto;
 `),A("image-card-type",`
 z-index: 2;
 position: absolute;
 width: 100%;
 height: 100%;
 left: 0;
 right: 0;
 bottom: 0;
 top: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 `)]),ee("name",`
 color: var(--n-item-text-color);
 flex: 1;
 display: flex;
 justify-content: center;
 text-overflow: ellipsis;
 overflow: hidden;
 flex-direction: column;
 text-decoration-color: #0000;
 font-size: var(--n-font-size);
 transition:
 color .3s var(--n-bezier),
 text-decoration-color .3s var(--n-bezier); 
 `,[K("a",`
 color: inherit;
 text-decoration: underline;
 `)])])])]),T("upload-file-input",`
 display: none;
 width: 0;
 height: 0;
 opacity: 0;
 `)]),ht="__UPLOAD_DRAGGER__",vt=Y({name:"UploadDragger",[ht]:!0,setup(e,{slots:t}){const a=le(be,null);return a||Re("upload-dragger","`n-upload-dragger` must be placed inside `n-upload`."),()=>{const{mergedClsPrefixRef:{value:n},mergedDisabledRef:{value:s},maxReachedRef:{value:l}}=a;return u("div",{class:[`${n}-upload-dragger`,(s||l)&&`${n}-upload-dragger--disabled`]},t)}}}),Fn=u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},u("g",{fill:"none"},u("path",{d:"M21.75 3A3.25 3.25 0 0 1 25 6.25v15.5A3.25 3.25 0 0 1 21.75 25H6.25A3.25 3.25 0 0 1 3 21.75V6.25A3.25 3.25 0 0 1 6.25 3h15.5zm.583 20.4l-7.807-7.68a.75.75 0 0 0-.968-.07l-.084.07l-7.808 7.68c.183.065.38.1.584.1h15.5c.204 0 .4-.035.583-.1l-7.807-7.68l7.807 7.68zM21.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v15.5c0 .208.036.408.103.593l7.82-7.692a2.25 2.25 0 0 1 3.026-.117l.129.117l7.82 7.692c.066-.185.102-.385.102-.593V6.25a1.75 1.75 0 0 0-1.75-1.75zm-3.25 3a2.5 2.5 0 1 1 0 5a2.5 2.5 0 0 1 0-5zm0 1.5a1 1 0 1 0 0 2a1 1 0 0 0 0-2z",fill:"currentColor"}))),In=u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 28"},u("g",{fill:"none"},u("path",{d:"M6.4 2A2.4 2.4 0 0 0 4 4.4v19.2A2.4 2.4 0 0 0 6.4 26h15.2a2.4 2.4 0 0 0 2.4-2.4V11.578c0-.729-.29-1.428-.805-1.944l-6.931-6.931A2.4 2.4 0 0 0 14.567 2H6.4zm-.9 2.4a.9.9 0 0 1 .9-.9H14V10a2 2 0 0 0 2 2h6.5v11.6a.9.9 0 0 1-.9.9H6.4a.9.9 0 0 1-.9-.9V4.4zm16.44 6.1H16a.5.5 0 0 1-.5-.5V4.06l6.44 6.44z",fill:"currentColor"}))),jn=Y({name:"UploadProgress",props:{show:Boolean,percentage:{type:Number,required:!0},status:{type:String,required:!0}},setup(){return{mergedTheme:le(be).mergedThemeRef}},render(){return u(qe,null,{default:()=>this.show?u(gt,{type:"line",showIndicator:!1,percentage:this.percentage,status:this.status,height:2,theme:this.mergedTheme.peers.Progress,themeOverrides:this.mergedTheme.peerOverrides.Progress}):null})}});var Ve=function(e,t,a,n){function s(l){return l instanceof a?l:new a(function(i){i(l)})}return new(a||(a=Promise))(function(l,i){function m(r){try{o(n.next(r))}catch(g){i(g)}}function d(r){try{o(n.throw(r))}catch(g){i(g)}}function o(r){r.done?l(r.value):s(r.value).then(m,d)}o((n=n.apply(e,t||[])).next())})};function bt(e){return e.includes("image/")}function lt(e=""){const t=e.split("/"),n=t[t.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(n)||[""])[0]}const it=/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i,yt=e=>{if(e.type)return bt(e.type);const t=lt(e.name||"");if(it.test(t))return!0;const a=e.thumbnailUrl||e.url||"",n=lt(a);return!!(/^data:image\//.test(a)||it.test(n))};function Un(e){return Ve(this,void 0,void 0,function*(){return yield new Promise(t=>{if(!e.type||!bt(e.type)){t("");return}t(window.URL.createObjectURL(e))})})}const Dn=Ft&&window.FileReader&&window.File;function Mn(e){return e.isDirectory}function An(e){return e.isFile}function Nn(e,t){return Ve(this,void 0,void 0,function*(){const a=[];function n(s){return Ve(this,void 0,void 0,function*(){for(const l of s)if(l){if(t&&Mn(l)){const i=l.createReader();let m=[],d;try{do d=yield new Promise((o,r)=>{i.readEntries(o,r)}),m=m.concat(d);while(d.length>0)}catch(o){Je("upload","error happens when handling directory upload",o)}yield n(m)}else if(An(l))try{const i=yield new Promise((m,d)=>{l.file(m,d)});a.push({file:i,entry:l,source:"dnd"})}catch(i){Je("upload","error happens when handling file upload",i)}}})}return yield n(e),a})}function ke(e){const{id:t,name:a,percentage:n,status:s,url:l,file:i,thumbnailUrl:m,type:d,fullPath:o,batchId:r}=e;return{id:t,name:a,percentage:n??null,status:s,url:l??null,file:i??null,thumbnailUrl:m??null,type:d??null,fullPath:o??null,batchId:r??null}}function En(e,t,a){return e=e.toLowerCase(),t=t.toLocaleLowerCase(),a=a.toLocaleLowerCase(),a.split(",").map(s=>s.trim()).filter(Boolean).some(s=>{if(s.startsWith(".")){if(e.endsWith(s))return!0}else if(s.includes("/")){const[l,i]=t.split("/"),[m,d]=s.split("/");if((m==="*"||l&&m&&m===l)&&(d==="*"||i&&d&&d===i))return!0}else return!0;return!1})}var ot=function(e,t,a,n){function s(l){return l instanceof a?l:new a(function(i){i(l)})}return new(a||(a=Promise))(function(l,i){function m(r){try{o(n.next(r))}catch(g){i(g)}}function d(r){try{o(n.throw(r))}catch(g){i(g)}}function o(r){r.done?l(r.value):s(r.value).then(m,d)}o((n=n.apply(e,t||[])).next())})};const Le={paddingMedium:"0 3px",heightMedium:"24px",iconSizeMedium:"18px"},Vn=Y({name:"UploadFile",props:{clsPrefix:{type:String,required:!0},file:{type:Object,required:!0},listType:{type:String,required:!0},index:{type:Number,required:!0}},setup(e){const t=le(be),a=$(null),n=$(""),s=_(()=>{const{file:x}=e;return x.status==="finished"?"success":x.status==="error"?"error":"info"}),l=_(()=>{const{file:x}=e;if(x.status==="error")return"error"}),i=_(()=>{const{file:x}=e;return x.status==="uploading"}),m=_(()=>{if(!t.showCancelButtonRef.value)return!1;const{file:x}=e;return["uploading","pending","error"].includes(x.status)}),d=_(()=>{if(!t.showRemoveButtonRef.value)return!1;const{file:x}=e;return["finished"].includes(x.status)}),o=_(()=>{if(!t.showDownloadButtonRef.value)return!1;const{file:x}=e;return["finished"].includes(x.status)}),r=_(()=>{if(!t.showRetryButtonRef.value)return!1;const{file:x}=e;return["error"].includes(x.status)}),g=jt(()=>n.value||e.file.thumbnailUrl||e.file.url),S=_(()=>{if(!t.showPreviewButtonRef.value)return!1;const{file:{status:x},listType:z}=e;return["finished"].includes(x)&&g.value&&z==="image-card"});function F(){return ot(this,void 0,void 0,function*(){const x=t.onRetryRef.value;x&&(yield x({file:e.file}))===!1||t.submit(e.file.id)})}function b(x){x.preventDefault();const{file:z}=e;["finished","pending","error"].includes(z.status)?v(z):["uploading"].includes(z.status)?k(z):Ne("upload","The button clicked type is unknown.")}function R(x){x.preventDefault(),P(e.file)}function v(x){const{xhrMap:z,doChange:L,onRemoveRef:{value:ne},mergedFileListRef:{value:f}}=t;Promise.resolve(ne?ne({file:Object.assign({},x),fileList:f,index:e.index}):!0).then(w=>{if(w===!1)return;const O=Object.assign({},x,{status:"removed"});z.delete(x.id),L(O,void 0,{remove:!0})})}function P(x){const{onDownloadRef:{value:z}}=t;Promise.resolve(z?z(Object.assign({},x)):!0).then(L=>{L!==!1&&ln(x.url,x.name)})}function k(x){const{xhrMap:z}=t,L=z.get(x.id);L==null||L.abort(),v(Object.assign({},x))}function D(x){const{onPreviewRef:{value:z}}=t;if(z)z(e.file,{event:x});else if(e.listType==="image-card"){const{value:L}=a;if(!L)return;L.click()}}const H=()=>ot(this,void 0,void 0,function*(){const{listType:x}=e;x!=="image"&&x!=="image-card"||t.shouldUseThumbnailUrlRef.value(e.file)&&(n.value=yield t.getFileThumbnailUrlResolver(e.file))});return Ut(()=>{H()}),{mergedTheme:t.mergedThemeRef,progressStatus:s,buttonType:l,showProgress:i,disabled:t.mergedDisabledRef,showCancelButton:m,showRemoveButton:d,showDownloadButton:o,showRetryButton:r,showPreviewButton:S,mergedThumbnailUrl:g,shouldUseThumbnailUrl:t.shouldUseThumbnailUrlRef,renderIcon:t.renderIconRef,imageRef:a,handleRemoveOrCancelClick:b,handleDownloadClick:R,handleRetryClick:F,handlePreviewClick:D}},render(){const{clsPrefix:e,mergedTheme:t,listType:a,file:n,renderIcon:s}=this;let l;const i=a==="image";i||a==="image-card"?l=!this.shouldUseThumbnailUrl(n)||!this.mergedThumbnailUrl?u("span",{class:`${e}-upload-file-info__thumbnail`},s?s(n):yt(n)?u(se,{clsPrefix:e},{default:Fn}):u(se,{clsPrefix:e},{default:In})):u("a",{rel:"noopener noreferer",target:"_blank",href:n.url||void 0,class:`${e}-upload-file-info__thumbnail`,onClick:this.handlePreviewClick},a==="image-card"?u(an,{src:this.mergedThumbnailUrl||void 0,previewSrc:n.url||void 0,alt:n.name,ref:"imageRef"}):u("img",{src:this.mergedThumbnailUrl||void 0,alt:n.name})):l=u("span",{class:`${e}-upload-file-info__thumbnail`},s?s(n):u(se,{clsPrefix:e},{default:()=>u(pn,null)}));const d=u(jn,{show:this.showProgress,percentage:n.percentage||0,status:this.progressStatus}),o=a==="text"||a==="image";return u("div",{class:[`${e}-upload-file`,`${e}-upload-file--${this.progressStatus}-status`,n.url&&n.status!=="error"&&a!=="image-card"&&`${e}-upload-file--with-url`,`${e}-upload-file--${a}-type`]},u("div",{class:`${e}-upload-file-info`},l,u("div",{class:`${e}-upload-file-info__name`},o&&(n.url&&n.status!=="error"?u("a",{rel:"noopener noreferer",target:"_blank",href:n.url||void 0,onClick:this.handlePreviewClick},n.name):u("span",{onClick:this.handlePreviewClick},n.name)),i&&d),u("div",{class:[`${e}-upload-file-info__action`,`${e}-upload-file-info__action--${a}-type`]},this.showPreviewButton?u(J,{key:"preview",quaternary:!0,type:this.buttonType,onClick:this.handlePreviewClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:Le},{icon:()=>u(se,{clsPrefix:e},{default:()=>u(vn,null)})}):null,(this.showRemoveButton||this.showCancelButton)&&!this.disabled&&u(J,{key:"cancelOrTrash",theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,quaternary:!0,builtinThemeOverrides:Le,type:this.buttonType,onClick:this.handleRemoveOrCancelClick},{icon:()=>u(It,null,{default:()=>this.showRemoveButton?u(se,{clsPrefix:e,key:"trash"},{default:()=>u(yn,null)}):u(se,{clsPrefix:e,key:"cancel"},{default:()=>u(hn,null)})})}),this.showRetryButton&&!this.disabled&&u(J,{key:"retry",quaternary:!0,type:this.buttonType,onClick:this.handleRetryClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:Le},{icon:()=>u(se,{clsPrefix:e},{default:()=>u(bn,null)})}),this.showDownloadButton?u(J,{key:"download",quaternary:!0,type:this.buttonType,onClick:this.handleDownloadClick,theme:t.peers.Button,themeOverrides:t.peerOverrides.Button,builtinThemeOverrides:Le},{icon:()=>u(se,{clsPrefix:e},{default:()=>u(rn,null)})}):null)),!i&&d)}}),wt=Y({name:"UploadTrigger",props:{abstract:Boolean},slots:Object,setup(e,{slots:t}){const a=le(be,null);a||Re("upload-trigger","`n-upload-trigger` must be placed inside `n-upload`.");const{mergedClsPrefixRef:n,mergedDisabledRef:s,maxReachedRef:l,listTypeRef:i,dragOverRef:m,openOpenFileDialog:d,draggerInsideRef:o,handleFileAddition:r,mergedDirectoryDndRef:g,triggerClassRef:S,triggerStyleRef:F}=a,b=_(()=>i.value==="image-card");function R(){s.value||l.value||d()}function v(H){H.preventDefault(),m.value=!0}function P(H){H.preventDefault(),m.value=!0}function k(H){H.preventDefault(),m.value=!1}function D(H){var x;if(H.preventDefault(),!o.value||s.value||l.value){m.value=!1;return}const z=(x=H.dataTransfer)===null||x===void 0?void 0:x.items;z!=null&&z.length?Nn(Array.from(z).map(L=>L.webkitGetAsEntry()),g.value).then(L=>{r(L)}).finally(()=>{m.value=!1}):m.value=!1}return()=>{var H;const{value:x}=n;return e.abstract?(H=t.default)===null||H===void 0?void 0:H.call(t,{handleClick:R,handleDrop:D,handleDragOver:v,handleDragEnter:P,handleDragLeave:k}):u("div",{class:[`${x}-upload-trigger`,(s.value||l.value)&&`${x}-upload-trigger--disabled`,b.value&&`${x}-upload-trigger--image-card`,S.value],style:F.value,onClick:R,onDrop:D,onDragover:v,onDragenter:P,onDragleave:k},b.value?u(vt,null,{default:()=>Dt(t.default,()=>[u(se,{clsPrefix:x},{default:()=>u(sn,null)})])}):t)}}}),qn=Y({name:"UploadFileList",setup(e,{slots:t}){const a=le(be,null);a||Re("upload-file-list","`n-upload-file-list` must be placed inside `n-upload`.");const{abstractRef:n,mergedClsPrefixRef:s,listTypeRef:l,mergedFileListRef:i,fileListClassRef:m,fileListStyleRef:d,cssVarsRef:o,themeClassRef:r,maxReachedRef:g,showTriggerRef:S,imageGroupPropsRef:F}=a,b=_(()=>l.value==="image-card"),R=()=>i.value.map((P,k)=>u(Vn,{clsPrefix:s.value,key:P.id,file:P,index:k,listType:l.value})),v=()=>b.value?u(on,Object.assign({},F.value),{default:R}):u(qe,{group:!0},{default:R});return()=>{const{value:P}=s,{value:k}=n;return u("div",{class:[`${P}-upload-file-list`,b.value&&`${P}-upload-file-list--grid`,k?r==null?void 0:r.value:void 0,m.value],style:[k&&o?o.value:"",d.value]},v(),S.value&&!g.value&&b.value&&u(wt,null,t))}}});var st=function(e,t,a,n){function s(l){return l instanceof a?l:new a(function(i){i(l)})}return new(a||(a=Promise))(function(l,i){function m(r){try{o(n.next(r))}catch(g){i(g)}}function d(r){try{o(n.throw(r))}catch(g){i(g)}}function o(r){r.done?l(r.value):s(r.value).then(m,d)}o((n=n.apply(e,t||[])).next())})};function Hn(e,t,a){const{doChange:n,xhrMap:s}=e;let l=0;function i(d){var o;let r=Object.assign({},t,{status:"error",percentage:l});s.delete(t.id),r=ke(((o=e.onError)===null||o===void 0?void 0:o.call(e,{file:r,event:d}))||r),n(r,d)}function m(d){var o;if(e.isErrorState){if(e.isErrorState(a)){i(d);return}}else if(a.status<200||a.status>=300){i(d);return}let r=Object.assign({},t,{status:"finished",percentage:l});s.delete(t.id),r=ke(((o=e.onFinish)===null||o===void 0?void 0:o.call(e,{file:r,event:d}))||r),n(r,d)}return{handleXHRLoad:m,handleXHRError:i,handleXHRAbort(d){const o=Object.assign({},t,{status:"removed",file:null,percentage:l});s.delete(t.id),n(o,d)},handleXHRProgress(d){const o=Object.assign({},t,{status:"uploading"});if(d.lengthComputable){const r=Math.ceil(d.loaded/d.total*100);o.percentage=r,l=r}n(o,d)}}}function Wn(e){const{inst:t,file:a,data:n,headers:s,withCredentials:l,action:i,customRequest:m}=e,{doChange:d}=e.inst;let o=0;m({file:a,data:n,headers:s,withCredentials:l,action:i,onProgress(r){const g=Object.assign({},a,{status:"uploading"}),S=r.percent;g.percentage=S,o=S,d(g)},onFinish(){var r;let g=Object.assign({},a,{status:"finished",percentage:o});g=ke(((r=t.onFinish)===null||r===void 0?void 0:r.call(t,{file:g}))||g),d(g)},onError(){var r;let g=Object.assign({},a,{status:"error",percentage:o});g=ke(((r=t.onError)===null||r===void 0?void 0:r.call(t,{file:g}))||g),d(g)}})}function Gn(e,t,a){const n=Hn(e,t,a);a.onabort=n.handleXHRAbort,a.onerror=n.handleXHRError,a.onload=n.handleXHRLoad,a.upload&&(a.upload.onprogress=n.handleXHRProgress)}function xt(e,t){return typeof e=="function"?e({file:t}):e||{}}function Xn(e,t,a){const n=xt(t,a);n&&Object.keys(n).forEach(s=>{e.setRequestHeader(s,n[s])})}function Kn(e,t,a){const n=xt(t,a);n&&Object.keys(n).forEach(s=>{e.append(s,n[s])})}function Jn(e,t,a,{method:n,action:s,withCredentials:l,responseType:i,headers:m,data:d}){const o=new XMLHttpRequest;o.responseType=i,e.xhrMap.set(a.id,o),o.withCredentials=l;const r=new FormData;if(Kn(r,d,a),a.file!==null&&r.append(t,a.file),Gn(e,a,o),s!==void 0){o.open(n.toUpperCase(),s),Xn(o,m,a),o.send(r);const g=Object.assign({},a,{status:"uploading"});e.doChange(g)}}const Yn=Object.assign(Object.assign({},ge.props),{name:{type:String,default:"file"},accept:String,action:String,customRequest:Function,directory:Boolean,directoryDnd:{type:Boolean,default:void 0},method:{type:String,default:"POST"},multiple:Boolean,showFileList:{type:Boolean,default:!0},data:[Object,Function],headers:[Object,Function],withCredentials:Boolean,responseType:{type:String,default:""},disabled:{type:Boolean,default:void 0},onChange:Function,onRemove:Function,onFinish:Function,onError:Function,onRetry:Function,onBeforeUpload:Function,isErrorState:Function,onDownload:Function,defaultUpload:{type:Boolean,default:!0},fileList:Array,"onUpdate:fileList":[Function,Array],onUpdateFileList:[Function,Array],fileListClass:String,fileListStyle:[String,Object],defaultFileList:{type:Array,default:()=>[]},showCancelButton:{type:Boolean,default:!0},showRemoveButton:{type:Boolean,default:!0},showDownloadButton:Boolean,showRetryButton:{type:Boolean,default:!0},showPreviewButton:{type:Boolean,default:!0},listType:{type:String,default:"text"},onPreview:Function,shouldUseThumbnailUrl:{type:Function,default:e=>Dn?yt(e):!1},createThumbnailUrl:Function,abstract:Boolean,max:Number,showTrigger:{type:Boolean,default:!0},imageGroupProps:Object,inputProps:Object,triggerClass:String,triggerStyle:[String,Object],renderIcon:Function}),Qn=Y({name:"Upload",props:Yn,setup(e){e.abstract&&e.listType==="image-card"&&Re("upload","when the list-type is image-card, abstract is not supported.");const{mergedClsPrefixRef:t,inlineThemeDisabled:a}=He(e),n=ge("Upload","-upload",Bn,At,e,t),s=Nt(e),l=$(e.defaultFileList),i=M(e,"fileList"),m=$(null),d={value:!1},o=$(!1),r=new Map,g=Et(i,l),S=_(()=>g.value.map(ke)),F=_(()=>{const{max:f}=e;return f!==void 0?S.value.length>=f:!1});function b(){var f;(f=m.value)===null||f===void 0||f.click()}function R(f){const w=f.target;D(w.files?Array.from(w.files).map(O=>({file:O,entry:null,source:"input"})):null,f),w.value=""}function v(f){const{"onUpdate:fileList":w,onUpdateFileList:O}=e;w&&Ye(w,f),O&&Ye(O,f),l.value=f}const P=_(()=>e.multiple||e.directory),k=(f,w,O={append:!1,remove:!1})=>{const{append:N,remove:G}=O,C=Array.from(S.value),I=C.findIndex(B=>B.id===f.id);if(N||G||~I){N?C.push(f):G?C.splice(I,1):C.splice(I,1,f);const{onChange:B}=e;B&&B({file:f,fileList:C,event:w}),v(C)}};function D(f,w){if(!f||f.length===0)return;const{onBeforeUpload:O}=e;f=P.value?f:[f[0]];const{max:N,accept:G}=e;f=f.filter(({file:I,source:B})=>B==="dnd"&&(G!=null&&G.trim())?En(I.name,I.type,G):!0),N&&(f=f.slice(0,N-S.value.length));const C=Oe();Promise.all(f.map(I=>st(this,[I],void 0,function*({file:B,entry:j}){var X;const Q={id:Oe(),batchId:C,name:B.name,status:"pending",percentage:0,file:B,url:null,type:B.type,thumbnailUrl:null,fullPath:(X=j==null?void 0:j.fullPath)!==null&&X!==void 0?X:`/${B.webkitRelativePath||B.name}`};return!O||(yield O({file:Q,fileList:S.value}))!==!1?Q:null}))).then(I=>st(this,void 0,void 0,function*(){let B=Promise.resolve();I.forEach(j=>{B=B.then(Vt).then(()=>{j&&k(j,w,{append:!0})})}),yield B})).then(()=>{e.defaultUpload&&H()})}function H(f){const{method:w,action:O,withCredentials:N,headers:G,data:C,name:I}=e,B=f!==void 0?S.value.filter(X=>X.id===f):S.value,j=f!==void 0;B.forEach(X=>{const{status:Q}=X;(Q==="pending"||Q==="error"&&j)&&(e.customRequest?Wn({inst:{doChange:k,xhrMap:r,onFinish:e.onFinish,onError:e.onError},file:X,action:O,withCredentials:N,headers:G,data:C,customRequest:e.customRequest}):Jn({doChange:k,xhrMap:r,onFinish:e.onFinish,onError:e.onError,isErrorState:e.isErrorState},I,X,{method:w,action:O,withCredentials:N,responseType:e.responseType,headers:G,data:C}))})}function x(f){var w;if(f.thumbnailUrl)return f.thumbnailUrl;const{createThumbnailUrl:O}=e;return O?(w=O(f.file,f))!==null&&w!==void 0?w:f.url||"":f.url?f.url:f.file?Un(f.file):""}const z=_(()=>{const{common:{cubicBezierEaseInOut:f},self:{draggerColor:w,draggerBorder:O,draggerBorderHover:N,itemColorHover:G,itemColorHoverError:C,itemTextColorError:I,itemTextColorSuccess:B,itemTextColor:j,itemIconColor:X,itemDisabledOpacity:Q,lineHeight:ue,borderRadius:ce,fontSize:fe,itemBorderImageCardError:ie,itemBorderImageCard:oe}}=n.value;return{"--n-bezier":f,"--n-border-radius":ce,"--n-dragger-border":O,"--n-dragger-border-hover":N,"--n-dragger-color":w,"--n-font-size":fe,"--n-item-color-hover":G,"--n-item-color-hover-error":C,"--n-item-disabled-opacity":Q,"--n-item-icon-color":X,"--n-item-text-color":j,"--n-item-text-color-error":I,"--n-item-text-color-success":B,"--n-line-height":ue,"--n-item-border-image-card-error":ie,"--n-item-border-image-card":oe}}),L=a?We("upload",void 0,z,e):void 0;Be(be,{mergedClsPrefixRef:t,mergedThemeRef:n,showCancelButtonRef:M(e,"showCancelButton"),showDownloadButtonRef:M(e,"showDownloadButton"),showRemoveButtonRef:M(e,"showRemoveButton"),showRetryButtonRef:M(e,"showRetryButton"),onRemoveRef:M(e,"onRemove"),onDownloadRef:M(e,"onDownload"),mergedFileListRef:S,triggerClassRef:M(e,"triggerClass"),triggerStyleRef:M(e,"triggerStyle"),shouldUseThumbnailUrlRef:M(e,"shouldUseThumbnailUrl"),renderIconRef:M(e,"renderIcon"),xhrMap:r,submit:H,doChange:k,showPreviewButtonRef:M(e,"showPreviewButton"),onPreviewRef:M(e,"onPreview"),getFileThumbnailUrlResolver:x,listTypeRef:M(e,"listType"),dragOverRef:o,openOpenFileDialog:b,draggerInsideRef:d,handleFileAddition:D,mergedDisabledRef:s.mergedDisabledRef,maxReachedRef:F,fileListClassRef:M(e,"fileListClass"),fileListStyleRef:M(e,"fileListStyle"),abstractRef:M(e,"abstract"),acceptRef:M(e,"accept"),cssVarsRef:a?void 0:z,themeClassRef:L==null?void 0:L.themeClass,onRender:L==null?void 0:L.onRender,showTriggerRef:M(e,"showTrigger"),imageGroupPropsRef:M(e,"imageGroupProps"),mergedDirectoryDndRef:_(()=>{var f;return(f=e.directoryDnd)!==null&&f!==void 0?f:e.directory}),onRetryRef:M(e,"onRetry")});const ne={clear:()=>{l.value=[]},submit:H,openOpenFileDialog:b};return Object.assign({mergedClsPrefix:t,draggerInsideRef:d,inputElRef:m,mergedTheme:n,dragOver:o,mergedMultiple:P,cssVars:a?void 0:z,themeClass:L==null?void 0:L.themeClass,onRender:L==null?void 0:L.onRender,handleFileInputChange:R},ne)},render(){var e,t;const{draggerInsideRef:a,mergedClsPrefix:n,$slots:s,directory:l,onRender:i}=this;if(s.default&&!this.abstract){const d=s.default()[0];!((e=d==null?void 0:d.type)===null||e===void 0)&&e[ht]&&(a.value=!0)}const m=u("input",Object.assign({},this.inputProps,{ref:"inputElRef",type:"file",class:`${n}-upload-file-input`,accept:this.accept,multiple:this.mergedMultiple,onChange:this.handleFileInputChange,webkitdirectory:l||void 0,directory:l||void 0}));return this.abstract?u(Fe,null,(t=s.default)===null||t===void 0?void 0:t.call(s),u(Mt,{to:"body"},m)):(i==null||i(),u("div",{class:[`${n}-upload`,a.value&&`${n}-upload--dragger-inside`,this.dragOver&&`${n}-upload--drag-over`,this.themeClass],style:this.cssVars},m,this.showTrigger&&this.listType!=="image-card"&&u(wt,null,s),this.showFileList&&u(qn,null,s)))}}),Zn={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ea=Y({name:"AlertCircleOutline",render:function(t,a){return V(),te("svg",Zn,a[0]||(a[0]=[y("path",{d:"M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),y("path",{d:"M250.26 166.05L256 288l5.73-121.95a5.74 5.74 0 0 0-5.79-6h0a5.74 5.74 0 0 0-5.68 6z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{d:"M256 367.91a20 20 0 1 1 20-20a20 20 0 0 1-20 20z",fill:"currentColor"},null,-1)]))}}),ta={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},na=Y({name:"CloudUpload",render:function(t,a){return V(),te("svg",ta,a[0]||(a[0]=[y("path",{d:"M473.66 210c-14-10.38-31.2-18-49.36-22.11a16.11 16.11 0 0 1-12.19-12.22c-7.8-34.75-24.59-64.55-49.27-87.13C334.15 62.25 296.21 47.79 256 47.79c-35.35 0-68 11.08-94.37 32.05a150.07 150.07 0 0 0-42.06 53a16 16 0 0 1-11.31 8.87c-26.75 5.4-50.9 16.87-69.34 33.12C13.46 197.33 0 227.24 0 261.39c0 34.52 14.49 66 40.79 88.76c25.12 21.69 58.94 33.64 95.21 33.64h104V230.42l-36.69 36.69a16 16 0 0 1-23.16-.56c-5.8-6.37-5.24-16.3.85-22.39l63.69-63.68a16 16 0 0 1 22.62 0L331 244.14c6.28 6.29 6.64 16.6.39 22.91a16 16 0 0 1-22.68.06L272 230.42v153.37h124c31.34 0 59.91-8.8 80.45-24.77c23.26-18.1 35.55-44 35.55-74.83c0-29.94-13.26-55.61-38.34-74.19z",fill:"currentColor"},null,-1),y("path",{d:"M240 448.21a16 16 0 1 0 32 0v-64.42h-32z",fill:"currentColor"},null,-1)]))}}),aa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ra=Y({name:"DownloadOutline",render:function(t,a){return V(),te("svg",aa,a[0]||(a[0]=[y("path",{d:"M336 176h40a40 40 0 0 1 40 40v208a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V216a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M176 272l80 80l80-80"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 48v288"},null,-1)]))}}),la={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},dt=Y({name:"SettingsOutline",render:function(t,a){return V(),te("svg",la,a[0]||(a[0]=[y("path",{d:"M262.29 192.31a64 64 0 1 0 57.4 57.4a64.13 64.13 0 0 0-57.4-57.4zM416.39 256a154.34 154.34 0 0 1-1.53 20.79l45.21 35.46a10.81 10.81 0 0 1 2.45 13.75l-42.77 74a10.81 10.81 0 0 1-13.14 4.59l-44.9-18.08a16.11 16.11 0 0 0-15.17 1.75A164.48 164.48 0 0 1 325 400.8a15.94 15.94 0 0 0-8.82 12.14l-6.73 47.89a11.08 11.08 0 0 1-10.68 9.17h-85.54a11.11 11.11 0 0 1-10.69-8.87l-6.72-47.82a16.07 16.07 0 0 0-9-12.22a155.3 155.3 0 0 1-21.46-12.57a16 16 0 0 0-15.11-1.71l-44.89 18.07a10.81 10.81 0 0 1-13.14-4.58l-42.77-74a10.8 10.8 0 0 1 2.45-13.75l38.21-30a16.05 16.05 0 0 0 6-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 0 0-6.07-13.94l-38.19-30A10.81 10.81 0 0 1 49.48 186l42.77-74a10.81 10.81 0 0 1 13.14-4.59l44.9 18.08a16.11 16.11 0 0 0 15.17-1.75A164.48 164.48 0 0 1 187 111.2a15.94 15.94 0 0 0 8.82-12.14l6.73-47.89A11.08 11.08 0 0 1 213.23 42h85.54a11.11 11.11 0 0 1 10.69 8.87l6.72 47.82a16.07 16.07 0 0 0 9 12.22a155.3 155.3 0 0 1 21.46 12.57a16 16 0 0 0 15.11 1.71l44.89-18.07a10.81 10.81 0 0 1 13.14 4.58l42.77 74a10.8 10.8 0 0 1-2.45 13.75l-38.21 30a16.05 16.05 0 0 0-6.05 14.08c.33 4.14.55 8.3.55 12.47z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),ia={class:"file-uploader"},oa={class:"upload-content"},sa={key:0,class:"upload-progress"},da={class:"file-info"},ua={class:"filename"},ca={class:"status"},fa=Y({__name:"FileUploader",setup(e){const t=pt(),a=$(),n=$(null),s=$(0),l=$("idle"),i=_(()=>l.value==="uploading"),m=_(()=>{switch(l.value){case"uploading":return"上传中...";case"success":return"上传成功";case"error":return"上传失败";default:return""}}),d=r=>r.file.name.endsWith(".py")?!0:(t.error("只能上传Python文件(.py)"),!1),o=async r=>{var g,S;try{n.value=r.file.file,l.value="uploading",s.value=0;const F=new FormData;F.append("file",r.file.file);const{data:b}=await en.post("/api/upload",F,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:R=>{const v=Math.round(R.loaded*100/(R.total??R.loaded));s.value=v,r.onProgress({percent:v})}});if(console.log(b),(b==null?void 0:b.status)==="success")l.value="success",s.value=100,t.success("文件上传成功"),r.onFinish();else throw new Error((b==null?void 0:b.message)||"上传失败")}catch(F){l.value="error";const b=((S=(g=F.response)==null?void 0:g.data)==null?void 0:S.message)||F.message||"未知错误";t.error(`上传失败: ${b}`),r.onError()}};return(r,g)=>(V(),te("div",ia,[p(c(Qn),{ref_key:"uploadRef",ref:a,accept:".py","custom-request":o,"show-file-list":!1,onBeforeUpload:d},{default:h(()=>[p(c(vt),null,{default:h(()=>[y("div",oa,[p(c(re),{size:"48",class:"upload-icon"},{default:h(()=>[p(c(na))]),_:1}),g[0]||(g[0]=y("div",{class:"upload-text"},[y("p",null,"点击或拖拽上传Python文件"),y("p",{class:"upload-hint"},"仅支持.py文件")],-1))])]),_:1})]),_:1},512),n.value?(V(),te("div",sa,[y("div",da,[y("span",ua,W(n.value.name),1),y("span",ca,W(m.value),1)]),i.value?(V(),de(c(gt),{key:0,percentage:s.value,processing:!0,type:"line"},null,8,["percentage"])):ve("",!0)])):ve("",!0)]))}}),ma=Xe(fa,[["__scopeId","data-v-9bd597bf"]]),ga={class:"connection-status"},pa={class:"status-text"},ha={class:"message-filters"},va={key:0,class:"empty-logs"},ba={key:1,class:"log-list"},ya={class:"log-time"},wa={class:"log-message"},xa=Y({__name:"TrainingLog",setup(e,{expose:t}){const a=we("theme-mode",!1),n=$([]),s=$(null),l=$(!1),i=$("all"),m=$(""),d=()=>{var R;((R=s.value)==null?void 0:R.readyState)!==WebSocket.OPEN&&(s.value=new WebSocket("ws://3618686a.r39.cpolar.top"),s.value.onopen=()=>{l.value=!0,r("WebSocket 连接已建立","system")},s.value.onclose=()=>{l.value=!1,r("WebSocket 连接已断开","system")},s.value.onerror=v=>{r(`WebSocket 错误: ${v}`,"error")},s.value.onmessage=v=>{try{const P=JSON.parse(v.data);if(P.type==="terminal"&&P.content)try{const k=JSON.parse(P.content);r(k.content||k.message,k.type||"info");return}catch{}r(P.content||P.message,P.type||"info")}catch(P){console.error("JSON parse error:",P),console.error("Raw data that failed to parse:",v.data),r(`JSON解析错误: ${v.data}`,"error")}})},o=()=>{var R;(R=s.value)==null||R.close(),s.value=null},r=(R,v="info")=>{n.value.push({message:R,level:v,timestamp:new Date().toLocaleTimeString()})},g=()=>{n.value=[]},S=()=>{const R=n.value.map(D=>`[${D.timestamp}] [${D.level.toUpperCase()}] ${D.message}`).join(`
`),v=new Blob([R],{type:"text/plain"}),P=URL.createObjectURL(v),k=document.createElement("a");k.href=P,k.download=`training-log-${new Date().toISOString()}.txt`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(P)},F=R=>({info:"info",warning:"warning",error:"error",success:"success",system:"default",terminal:"primary",hyperparameter:"warning"})[R]||"default",b=_(()=>n.value.filter(R=>{const v=i.value==="all"||R.level===i.value,P=!m.value||R.message.toString().toLowerCase().includes(m.value.toLowerCase())||R.level.toLowerCase().includes(m.value.toLowerCase());return v&&P}));return mt(()=>{d()}),qt(()=>{o()}),t({addLog:r}),(R,v)=>{const P=Ht("n-input");return V(),de(c(he),{title:"训练日志",bordered:!1,class:De([{dark:c(a)},"training-log"])},{"header-extra":h(()=>[p(c(xe),null,{default:h(()=>[y("div",ga,[y("div",{class:De(["status-indicator",l.value?"connected":"disconnected"])},null,2),y("span",pa,W(l.value?"已连接":"未连接"),1)]),p(c(J),{quaternary:"",disabled:l.value,onClick:d},{default:h(()=>v[7]||(v[7]=[q(" 连接 ")])),_:1},8,["disabled"]),p(c(J),{quaternary:"",disabled:!l.value,onClick:o},{default:h(()=>v[8]||(v[8]=[q(" 断开 ")])),_:1},8,["disabled"]),p(c(Wt),{onPositiveClick:g,"positive-text":"确认","negative-text":"取消"},{trigger:h(()=>[p(c(J),{quaternary:"",circle:""},{default:h(()=>[p(c(re),null,{default:h(()=>[p(c(Gt))]),_:1})]),_:1})]),default:h(()=>[v[9]||(v[9]=q(" 确定要清空所有日志吗？ "))]),_:1}),p(c(J),{quaternary:"",circle:"",onClick:S},{default:h(()=>[p(c(re),null,{default:h(()=>[p(c(ra))]),_:1})]),_:1})]),_:1})]),default:h(()=>[y("div",ha,[p(c(xe),{align:"center"},{default:h(()=>[p(c(J),{type:i.value==="all"?"primary":"default",size:"small",onClick:v[0]||(v[0]=k=>i.value="all")},{default:h(()=>v[10]||(v[10]=[q(" 全部 ")])),_:1},8,["type"]),p(c(J),{type:i.value==="info"?"primary":"default",size:"small",onClick:v[1]||(v[1]=k=>i.value="info")},{default:h(()=>v[11]||(v[11]=[q(" 信息 ")])),_:1},8,["type"]),p(c(J),{type:i.value==="warning"?"primary":"default",size:"small",onClick:v[2]||(v[2]=k=>i.value="warning")},{default:h(()=>v[12]||(v[12]=[q(" 警告 ")])),_:1},8,["type"]),p(c(J),{type:i.value==="error"?"primary":"default",size:"small",onClick:v[3]||(v[3]=k=>i.value="error")},{default:h(()=>v[13]||(v[13]=[q(" 错误 ")])),_:1},8,["type"]),p(c(J),{type:i.value==="terminal"?"primary":"default",size:"small",onClick:v[4]||(v[4]=k=>i.value="terminal")},{default:h(()=>v[14]||(v[14]=[q(" 终端 ")])),_:1},8,["type"]),p(c(J),{type:i.value==="hyperparameter"?"primary":"default",size:"small",onClick:v[5]||(v[5]=k=>i.value="hyperparameter")},{default:h(()=>v[15]||(v[15]=[q(" 超参数 ")])),_:1},8,["type"]),p(P,{modelValue:m.value,"onUpdate:modelValue":v[6]||(v[6]=k=>m.value=k),placeholder:"搜索日志...",size:"small"},null,8,["modelValue"])]),_:1})]),p(c(On),{style:{"max-height":"400px"},class:"log-container"},{default:h(()=>[b.value.length===0?(V(),te("div",va," 暂无日志信息 ")):(V(),te("div",ba,[(V(!0),te(Fe,null,Ee(b.value,(k,D)=>(V(),te("div",{key:D,class:De(["log-item",k.level])},[y("span",ya,"["+W(k.timestamp)+"]",1),p(c(ze),{type:F(k.level),size:"small",class:"log-level"},{default:h(()=>[q(W(k.level.toUpperCase()),1)]),_:2},1032,["type"]),y("span",wa,W(k.message),1)],2))),128))]))]),_:1})]),_:1},8,["class"])}}}),ka=Xe(xa,[["__scopeId","data-v-742f2499"]]),Ra={class:"analysis-container"},Ca={class:"advanced-config"},_a={class:"hyperparams-content"},Sa={class:"param-header"},Ta={class:"param-name"},Pa={class:"param-details"},$a={class:"param-description"},La={class:"param-meta"},za={class:"param-range"},Oa={class:"param-default"},Ba={key:0,class:"param-current"},Fa={key:0,class:"param-impact"},Ia={class:"impact-text"},ja={class:"description-content"},Ua={class:"description-content"},Da={class:"description-content"},Ma={class:"description-content"},Aa=Y({__name:"ModelAnalysis",setup(e){const t=$(["FileUploader"]),a=pt(),n=kn(),s=Zt(),l=Xt(),i=we("analysis-type",null),m=we("show-advanced-config",!1),d=we("advanced-config",{attackStrength:.3,iterations:100,usePrivacy:!1}),o=we("batch-mode",!1),r=$(!1),g=$(null),S=$([]),F=$(0);let b=$(null);const R=$({acc:"",status:"",message:{},attack_type:"",use_privacy:!1,hasimage:!1,images:[],mse_values:[],ssim_values:[],clf1:0,clf2:0,epsilon:0});Be("analysisResult",g),Be("realResult",R);const v=[{label:"对抗攻击评估",value:"all",description:"全面评估模型在面对对抗样本时的防御能力，包括FGSM、PGD等主流白盒攻击和迁移攻击等黑盒攻击场景。",principle:"通过梯度信息或启发式方法生成微扰动样本，测试模型对输入扰动的敏感性和决策边界的稳定性。",impact:"模型可能在微小扰动下产生误判，在安全攸关场景（如自动驾驶、医疗诊断）可能造成严重后果。",defense:"推荐采用对抗训练、随机化防御、特征压缩等技术增强模型鲁棒性，构建多层防御机制。"},{label:"后门攻击分析",value:"backdoor",description:"深入检测模型训练数据中的潜在后门和触发器，评估数据投毒攻击的影响范围和成功率。",principle:"分析训练数据分布异常和模型行为特征，识别可能被植入的后门触发模式和攻击目标。",impact:"攻击者可通过触发特定模式操控模型行为，在特定场景下引发定向误分类，威胁系统可靠性。",defense:"建议结合神经元修剪、模型净化、对抗验证等技术，同时加强数据质量控制和异常检测机制。"},{label:"模型推断风险",value:"dlg",description:"评估模型结构、参数和训练策略的保密性，防范模型克隆和知识产权盗取风险。",principle:"通过系统化的黑盒查询和输出分析，结合优化算法重建模型架构和关键参数信息。",impact:"可能导致核心算法泄露、商业模型被复制，并为定向攻击提供详细的目标信息。",defense:"推荐实施模型加密、梯度扰动、预测结果量化等技术手段，构建多层次的模型保护方案。"},{label:"成员推断风险",value:"mia",description:"全面评估模型在保护训练数据隐私方面的能力，识别潜在的数据成员泄露风险。",principle:"利用模型对训练样本和非训练样本的预测置信度差异，推断目标数据是否参与模型训练。",impact:"可能泄露敏感训练数据的成员身份，在医疗、金融等领域造成严重的隐私泄露问题。",defense:"建议采用差分隐私训练、知识蒸馏、预测结果泛化等技术，平衡模型性能和隐私保护需求。"}],P=$(!1),k=$(null),D=$(!1),H=$([{name:"学习率 (Learning Rate)",key:"lr",description:"控制模型参数更新的步长大小，影响训练收敛速度和稳定性。较高的学习率可能导致训练不稳定，较低的学习率会使训练过程缓慢。当前优化值: 0.075533",range:"0.001 - 0.5",defaultValue:.075533,category:"训练参数",currentValue:.075533,impact:"直接影响模型收敛速度和最终性能，是训练过程中最关键的超参数之一"},{name:"噪声乘数 (Noise Multiplier)",key:"noise_multiplier",description:"差分隐私训练中控制添加噪声强度的关键参数。较高的值提供更强的隐私保护但可能降低模型性能。当前优化值: 4.778214",range:"0.1 - 10.0",defaultValue:4.778214,category:"隐私参数",currentValue:4.778214,impact:"平衡隐私保护强度与模型实用性，是差分隐私机制的核心控制参数"},{name:"最大梯度范数 (Max Grad Norm)",key:"max_grad_norm",description:"梯度裁剪的阈值，防止梯度爆炸问题并确保训练稳定性。通过限制梯度的L2范数来控制参数更新幅度。当前优化值: 11.113912",range:"0.1 - 50.0",defaultValue:11.113912,category:"训练参数",currentValue:11.113912,impact:"防止梯度爆炸，确保训练过程的数值稳定性，特别在深度网络中至关重要"},{name:"批次大小 (Batch Size)",key:"batch_size",description:"每次前向传播处理的样本数量，影响内存使用、训练速度和模型收敛特性。较大批次提供更稳定的梯度估计。当前优化值: 64",range:"8 - 512",defaultValue:64,category:"性能参数",currentValue:64,impact:"影响训练效率、内存占用和梯度估计质量，需要根据硬件资源和数据特性调整"},{name:"训练轮数 (Epoch)",key:"epoch",description:"模型在整个训练数据集上的完整训练轮数。过少可能导致欠拟合，过多可能导致过拟合。当前优化值: 7",range:"1 - 100",defaultValue:7,category:"训练参数",currentValue:7,impact:"决定模型训练的充分程度，需要结合验证集性能来确定最优停止点"}]),x=ne=>{const f=v.find(w=>w.value===ne);f&&(k.value=f,P.value=!0)},z=ne=>({训练参数:"primary",隐私参数:"warning",对抗攻击:"error",优化参数:"info",性能参数:"success",推断参数:"default"})[ne]||"default",L=async()=>{if(!i.value){a.warning("请选择分析类型");return}if(o.value&&S.value.length===0){a.warning("请先上传模型文件");return}const ne=v.find(N=>N.value===i.value),f=ne?ne.label:"模型分析",w=l.addTask({name:f,type:f});b.value=w,l.startTask(w);let O=null;try{r.value=!0,F.value=0,O=setInterval(()=>{F.value<90&&(F.value+=10,l.updateProgress(w,F.value))},1e3);const N=await fetch("/api/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:i.value,use_privacy:d.value.usePrivacy})});if(!N.ok)throw new Error(`HTTP error! status: ${N.status}`);O&&(clearInterval(O),O=null),F.value=100,l.updateProgress(w,100);const G=await N.json();console.log("分析结果:",G),g.value=G,R.value=G,localStorage.setItem("latestAnalysisResult",JSON.stringify(G)),l.completeTask(w,G,a),n.success({title:"分析完成",content:"模型安全分析已完成，点击查看详细结果。",positiveText:"查看结果",negativeText:"稍后查看",onPositiveClick:()=>{s.push("/dashboard/model-analysis/result")}})}catch{O&&(clearInterval(O),O=null),l.errorTask(w,"请先设置配置信息",a)}finally{r.value=!1,b.value=null}};return ct(()=>{r.value=!1,F.value=0}),(ne,f)=>(V(),te("div",Ra,[p(c(xe),{vertical:"",size:"large"},{default:h(()=>[p(c(he),{title:"模型上传",class:"upload-card"},{default:h(()=>[p(ma)]),_:1}),(V(),de(Kt,{include:t.value},[c(o)&&S.value.length>0?(V(),de(c(he),{key:0,title:"文件列表"},{default:h(()=>[p(c(Qe),null,{default:h(()=>[(V(!0),te(Fe,null,Ee(S.value,w=>(V(),de(c(Ze),{key:w.id},{default:h(()=>[p(c(xe),{justify:"space-between",align:"center"},{default:h(()=>[y("span",null,W(w.name),1),p(c(ze),{type:w.status==="completed"?"success":w.status==="analyzing"?"warning":"default"},{default:h(()=>[q(W(w.status==="completed"?"已完成":w.status==="analyzing"?"分析中":"待分析"),1)]),_:2},1032,["type"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):ve("",!0)],1032,["include"])),p(c(he),{title:"分析配置",class:"config-card"},{default:h(()=>[p(c(xe),{vertical:""},{default:h(()=>[p(c(dn),{value:c(i),"onUpdate:value":[f[0]||(f[0]=w=>Jt(i)?i.value=w:null),x],options:v,placeholder:"选择分析类型"},null,8,["value"]),p(c(J),{text:"",onClick:f[1]||(f[1]=w=>m.value=!c(m))},{default:h(()=>[q(W(c(m)?"隐藏高级配置":"显示高级配置"),1)]),_:1}),p(c(tt),{show:c(m)},{default:h(()=>[y("div",Ca,[p(c(Ln),{label:"启用隐私保护"},{default:h(()=>[p(c(un),{value:c(d).usePrivacy,"onUpdate:value":f[2]||(f[2]=w=>c(d).usePrivacy=w)},null,8,["value"])]),_:1})])]),_:1},8,["show"]),p(c(J),{type:"primary",block:"",loading:r.value,disabled:!c(i),onClick:L},{default:h(()=>[q(W(r.value?"分析中...":"开始分析"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),c(d).usePrivacy?(V(),de(c(he),{key:0,title:"攻击超参数配置",class:"hyperparams-card"},{"header-extra":h(()=>[p(c(J),{text:"",onClick:f[3]||(f[3]=w=>D.value=!D.value)},{icon:h(()=>[p(c(re),null,{default:h(()=>[p(c(dt))]),_:1})]),default:h(()=>[q(" "+W(D.value?"收起":"查看详情"),1)]),_:1})]),default:h(()=>[p(c(Me),{type:"info",class:"hyperparams-intro"},{icon:h(()=>[p(c(re),null,{default:h(()=>[p(c(cn))]),_:1})]),default:h(()=>[f[5]||(f[5]=y("div",null,[y("p",null,[y("strong",null,"🔍 智能超参搜索已启用")]),y("p",null,"启用隐私保护后，系统会自动搜索最优的攻击参数组合，提升攻击效果和评估准确性。"),y("p",null,[y("strong",null,"💡 提示："),q("超参搜索会根据您的模型特征和数据集自动调优，无需手动配置。")])],-1))]),_:1}),p(c(tt),{show:D.value},{default:h(()=>[y("div",_a,[p(c(Me),{type:"warning",style:{"margin-bottom":"16px"}},{icon:h(()=>[p(c(re),null,{default:h(()=>[p(c(et))]),_:1})]),default:h(()=>[f[6]||(f[6]=y("div",null,[y("p",null,[y("strong",null,"⚠️ 重要说明")]),y("ul",{style:{margin:"8px 0","padding-left":"20px"}},[y("li",null,"以下参数值为系统自动优化结果，实际运行时会动态调整"),y("li",null,"超参搜索过程可能需要额外时间，但能显著提升攻击成功率"),y("li",null,"不同攻击类型会使用不同的参数组合策略")])],-1))]),_:1}),p(c(Qe),null,{default:h(()=>[(V(!0),te(Fe,null,Ee(H.value,w=>(V(),de(c(Ze),{key:w.key},{default:h(()=>[p(c(mn),null,{header:h(()=>[y("div",Sa,[y("span",Ta,W(w.name),1),p(c(ze),{size:"small",type:z(w.category)},{default:h(()=>[q(W(w.category),1)]),_:2},1032,["type"])])]),description:h(()=>[y("div",Pa,[y("p",$a,W(w.description),1),y("div",La,[y("span",za,"取值范围: "+W(w.range),1),y("span",Oa,"默认值: "+W(w.defaultValue),1),w.currentValue?(V(),te("span",Ba,"当前值: "+W(w.currentValue),1)):ve("",!0)]),w.impact?(V(),te("div",Fa,[p(c(ze),{size:"tiny",type:"info"},{default:h(()=>f[7]||(f[7]=[q("影响说明")])),_:1}),y("span",Ia,W(w.impact),1)])):ve("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1},8,["show"])]),_:1})):(V(),de(c(he),{key:1,title:"超参数优化",class:"hyperparams-card"},{default:h(()=>[p(c(Me),{type:"default"},{icon:h(()=>[p(c(re),null,{default:h(()=>[p(c(dt))]),_:1})]),default:h(()=>[f[8]||(f[8]=y("div",null,[y("p",null,[y("strong",null,"🔧 超参数自动优化")]),y("p",null,[q("开启"),y("strong",null,"隐私保护"),q("功能后，系统将启用智能超参搜索，自动为您的模型找到最优的攻击参数配置。")]),y("p",null,[y("strong",null,"优势：")]),y("ul",{style:{margin:"8px 0","padding-left":"20px"}},[y("li",null,"✅ 自动调优，无需手动配置复杂参数"),y("li",null,"✅ 提升攻击成功率和评估准确性"),y("li",null,"✅ 适配不同模型架构和数据集特征"),y("li",null,"✅ 节省调参时间，专注于安全分析结果")])],-1))]),_:1})]),_:1})),p(ka,{ref:"trainingLogRef"},null,512)]),_:1}),p(c(tn),{show:P.value,"onUpdate:show":f[4]||(f[4]=w=>P.value=w),width:480,placement:"right"},{default:h(()=>[k.value?(V(),de(c(nn),{key:0,title:k.value.label+" - 详细信息",class:"attack-info-drawer"},{default:h(()=>[p(c(Yt),{"label-placement":"left",column:1,class:"attack-descriptions"},{default:h(()=>[p(c($e),{label:"攻击描述","label-style":"font-weight: bold; color: var(--primary-color);"},{default:h(()=>[y("div",ja,[p(c(re),{size:"20",class:"description-icon"},{default:h(()=>[p(c(et))]),_:1}),q(" "+W(k.value.description),1)])]),_:1}),p(c($e),{label:"攻击原理","label-style":"font-weight: bold; color: var(--primary-color);"},{default:h(()=>[y("div",Ua,[p(c(re),{size:"20",class:"description-icon"},{default:h(()=>[p(c(Qt))]),_:1}),q(" "+W(k.value.principle),1)])]),_:1}),p(c($e),{label:"影响范围","label-style":"font-weight: bold; color: var(--primary-color);"},{default:h(()=>[y("div",Da,[p(c(re),{size:"20",class:"description-icon"},{default:h(()=>[p(c(ea))]),_:1}),q(" "+W(k.value.impact),1)])]),_:1}),p(c($e),{label:"防御建议","label-style":"font-weight: bold; color: var(--primary-color);"},{default:h(()=>[y("div",Ma,[p(c(re),{size:"20",class:"description-icon"},{default:h(()=>[p(c(fn))]),_:1}),q(" "+W(k.value.defense),1)])]),_:1})]),_:1})]),_:1},8,["title"])):ve("",!0)]),_:1},8,["show"])]))}}),Qa=Xe(Aa,[["__scopeId","data-v-c85de61a"]]);export{Qa as default};
