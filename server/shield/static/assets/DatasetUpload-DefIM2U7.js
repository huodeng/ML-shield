import{d as A,c as u,a as e,o as d,a9 as U,r as _,p as ss,w as m,g as r,u as o,aO as es,aP as C,k as b,j as I,aW as O,t as c,_ as E,bb as j,b as ts,aa as N,n as k,bc as S,m as as,F as os,f as ls}from"./index-Bxc172j1.js";import{b as ns,N as is,a as D}from"./index-BfFqGZ_4.js";import{I as rs}from"./ImageOutline-B8AC3KCE.js";import{N as ds}from"./Image-C7_q_JdY.js";import"./utils-DaFc0M5i.js";const cs={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ps=A({name:"StatsChartOutline",render:function(h,i){return d(),u("svg",cs,i[0]||(i[0]=[e("rect",{x:"64",y:"320",width:"48",height:"160",rx:"8",ry:"8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),e("rect",{x:"288",y:"224",width:"48",height:"256",rx:"8",ry:"8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),e("rect",{x:"400",y:"112",width:"48",height:"368",rx:"8",ry:"8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),e("rect",{x:"176",y:"32",width:"48",height:"448",rx:"8",ry:"8",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),us={class:"description-content"},ms={class:"description-content"},fs={class:"description-content"},vs={class:"description-content"},hs=A({__name:"DatasetInfoDrawer",props:{dataset:{}},setup(B,{expose:h}){const i=U("theme-mode",!1),p=_(!1);return h({open:()=>{p.value=!0},close:()=>{p.value=!1}}),(l,g)=>(d(),ss(o(is),{show:p.value,"onUpdate:show":g[0]||(g[0]=w=>p.value=w),width:480,placement:"right"},{default:m(()=>[r(o(ns),{title:l.dataset.name+" - 详细信息",class:"dataset-info-drawer","native-scrollbar":!1},{default:m(()=>[r(o(es),{"label-placement":"left",column:1,class:"dataset-descriptions"},{default:m(()=>[r(o(C),{label:"数据集描述","label-style":{"font-weight":"bold",color:o(i)?"var(--primary-color-dark)":"var(--primary-color)"}},{default:m(()=>[e("div",us,[r(o(I),{size:"20",class:"description-icon"},{default:m(()=>[r(o(O))]),_:1}),b(" "+c(l.dataset.description),1)])]),_:1},8,["label-style"]),r(o(C),{label:"样本数量","label-style":{"font-weight":"bold",color:o(i)?"var(--primary-color-dark)":"var(--primary-color)"}},{default:m(()=>[e("div",ms,[r(o(I),{size:"20",class:"description-icon"},{default:m(()=>[r(o(ps))]),_:1}),b(" "+c(l.dataset.samples),1)])]),_:1},8,["label-style"]),r(o(C),{label:"数据格式","label-style":{"font-weight":"bold",color:o(i)?"var(--primary-color-dark)":"var(--primary-color)"}},{default:m(()=>[e("div",fs,[r(o(I),{size:"20",class:"description-icon"},{default:m(()=>[r(o(rs))]),_:1}),b(" "+c(l.dataset.format),1)])]),_:1},8,["label-style"]),r(o(C),{label:"应用场景","label-style":{"font-weight":"bold",color:o(i)?"var(--primary-color-dark)":"var(--primary-color)"}},{default:m(()=>[e("div",vs,[r(o(I),{size:"20",class:"description-icon"},{default:m(()=>[r(o(O))]),_:1}),b(" "+c(l.dataset.applications),1)])]),_:1},8,["label-style"]),r(o(C),{label:"示例图片"},{default:m(()=>[r(o(ds),{src:l.dataset.imageUrl,width:"100%"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["show"]))}}),ws=E(hs,[["__scopeId","data-v-3532a149"]]),gs={class:"dataset-upload"},ys={class:"cards-container"},ks={class:"form-item"},_s={class:"select-wrapper"},bs=["value"],xs={class:"form-item"},zs={class:"switch-wrapper"},Cs={class:"switch"},Ds=["checked"],Is={class:"switch-text"},Ms={key:0,class:"upload-progress"},Ts={class:"progress-info"},Ns={class:"file-name"},Ss={class:"file-size"},Us={class:"progress-bar"},Bs={class:"progress-text"},Fs={class:"alert-icon"},Ls={class:"alert-content"},$s={class:"card-header"},Vs=["disabled"],Rs={key:0,class:"loading-state"},Hs={key:1,class:"empty-state"},Os={key:2,class:"datasets-list"},js={class:"dataset-info"},As={class:"dataset-name"},Es={class:"dataset-meta"},Zs={class:"dataset-size"},Ps={class:"dataset-date"},Gs={class:"dataset-type"},Ks={class:"dataset-actions"},Ws=["onClick"],qs=["onClick"],Js={class:"dataset-info"},Qs={__name:"DatasetUpload",setup(B){const h=U("theme-mode",!1),i=U("dataset-upload-form",{imgsize:32,isuplord:!0}),p=j({show:!1,content:"",type:"success"}),M=_(null),T=_({}),l=j({isUploading:!1,progress:0,fileName:"",fileSize:""}),g=_([{id:"1",name:"CIFAR-10-custom.npz",size:16384e4,uploadTime:"2024-01-15T10:30:00Z",type:"npz"},{id:"2",name:"mnist-train-data.csv",size:52428800,uploadTime:"2024-01-14T14:20:00Z",type:"csv"},{id:"3",name:"fashion-mnist.npy",size:78643200,uploadTime:"2024-01-13T09:15:00Z",type:"npy"},{id:"4",name:"custom-dataset.txt",size:10485760,uploadTime:"2024-01-12T16:45:00Z",type:"txt"},{id:"5",name:"image-classification-data.npz",size:209715200,uploadTime:"2024-01-11T11:30:00Z",type:"npz"}]),w=_(!1),f=(t,s="success")=>{p.show=!0,p.content=t,p.type=s},F=t=>{var s;T.value=t,(s=M.value)==null||s.open()},L=async()=>{var t,s,a;try{(await D.post("/api/config",{imgsize:i.value.imgsize,isuplord:i.value.isuplord})).data.status==="success"&&f("配置更新成功")}catch(n){f(((a=(s=(t=n.response)==null?void 0:t.data)==null?void 0:s.detail)==null?void 0:a.message)||"配置更新失败","error")}},Z=t=>{i.value.imgsize=t,L()},P=t=>{i.value.isuplord=t,L(),t&&x()},G=async(t,s)=>{var a,n,v;try{const y=await D.get(`/api/datasets/${t}/download`,{responseType:"blob"}),H=window.URL.createObjectURL(new Blob([y.data])),z=document.createElement("a");z.href=H,z.setAttribute("download",s),document.body.appendChild(z),z.click(),z.remove(),window.URL.revokeObjectURL(H),f("数据集下载成功")}catch(y){f(((v=(n=(a=y.response)==null?void 0:a.data)==null?void 0:n.detail)==null?void 0:v.message)||"数据集下载失败","error")}},K=t=>{t.status==="success"&&f("数据集上传成功")},W=t=>{f(t.message||"数据集上传失败","error")},q=t=>{t.lengthComputable&&(l.progress=Math.round(t.loaded/t.total*100))},x=async()=>{w.value=!0;try{const t=await D.get("/api/datasets");t.data.status==="success"&&(g.value=t.data.datasets||[])}catch(t){console.error("获取数据集列表失败:",t)}finally{w.value=!1}},J=async(t,s)=>{var a,n,v;if(confirm(`确定要删除数据集 "${s}" 吗？此操作不可撤销。`))try{(await D.delete(`/api/datasets/${t}`)).data.status==="success"&&(f("数据集删除成功"),await x())}catch(y){f(((v=(n=(a=y.response)==null?void 0:a.data)==null?void 0:n.detail)==null?void 0:v.message)||"数据集删除失败","error")}},$=t=>{if(t===0)return"0 B";const s=1024,a=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(s));return parseFloat((t/Math.pow(s,n)).toFixed(2))+" "+a[n]};ts(()=>{i.value.isuplord&&x()});const V=_(null),Q=()=>{var t;(t=V.value)==null||t.click()},X=async t=>{const s=t.target.files[0];if(!s)return;const a=[".csv",".npy",".npz",".txt"],n=s.name.substring(s.name.lastIndexOf(".")).toLowerCase();if(!a.includes(n)){f(`不支持的文件类型，仅支持${a.join(", ")}格式`,"error");return}await R(s)},Y=async t=>{const s=t.dataTransfer.files[0];if(!s)return;const a=[".csv",".npy",".npz",".txt"],n=s.name.substring(s.name.lastIndexOf(".")).toLowerCase();if(!a.includes(n)){f(`不支持的文件类型，仅支持${a.join(", ")}格式`,"error");return}await R(s)},R=async t=>{var a,n;l.isUploading=!0,l.progress=0,l.fileName=t.name,l.fileSize=$(t.size);const s=new FormData;s.append("file",t);try{const v=await D.post("/api/upload_dataset",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:q});K(v.data),await x()}catch(v){W(((n=(a=v.response)==null?void 0:a.data)==null?void 0:n.detail)||v)}finally{l.isUploading=!1,l.progress=0,l.fileName="",l.fileSize=""}};return(t,s)=>(d(),u("div",gs,[e("div",ys,[e("div",{class:k(["card config-card",{dark:o(h)}])},[s[10]||(s[10]=e("div",{class:"card-header"},[e("h3",null,"基本配置")],-1)),e("form",{class:"config-form",onSubmit:s[2]||(s[2]=S(()=>{},["prevent"]))},[e("div",ks,[s[7]||(s[7]=e("label",null,"图片大小",-1)),e("div",_s,[e("input",{type:"number",value:o(i).imgsize,onChange:s[0]||(s[0]=a=>Z(Number(a.target.value))),class:"custom-select",list:"imgsizeList",placeholder:"32",min:"1",max:"512"},null,40,bs)])]),e("div",xs,[s[9]||(s[9]=e("label",null,"上传数据集",-1)),e("div",zs,[e("label",Cs,[e("input",{type:"checkbox",checked:o(i).isuplord,onChange:s[1]||(s[1]=a=>P(a.target.checked))},null,40,Ds),s[8]||(s[8]=e("span",{class:"slider"},null,-1)),e("span",Is,c(o(i).isuplord?"是":"否"),1)])])])],32)],2),o(i).isuplord?(d(),u("div",{key:0,class:k(["card upload-card",{dark:o(h)}])},[s[13]||(s[13]=e("div",{class:"card-header"},[e("h3",null,"数据集上传")],-1)),e("div",{class:"upload-area",onDragover:s[3]||(s[3]=S(()=>{},["prevent"])),onDrop:S(Y,["prevent"]),onClick:Q},[e("input",{type:"file",ref_key:"fileInput",ref:V,style:{display:"none"},onChange:X},null,544),s[11]||(s[11]=e("div",{class:"upload-icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})])],-1)),s[12]||(s[12]=e("div",{class:"upload-text"},[b(" 将文件拖到此处，或"),e("em",null,"点击上传")],-1))],32),l.isUploading?(d(),u("div",Ms,[e("div",Ts,[e("span",Ns,c(l.fileName),1),e("span",Ss,c(l.fileSize),1)]),e("div",Us,[e("div",{class:"progress-fill",style:as({width:l.progress+"%"})},null,4)]),e("div",Bs,c(l.progress)+"%",1)])):N("",!0),p.show?(d(),u("div",{key:1,class:k(["alert",p.type])},[e("span",Fs,c(p.type==="success"?"✓":"✕"),1),e("span",Ls,c(p.content),1),e("button",{class:"alert-close",onClick:s[4]||(s[4]=a=>p.show=!1)},"×")],2)):N("",!0)],2)):N("",!0),o(i).isuplord?(d(),u("div",{key:1,class:k(["card uploaded-datasets-card",{dark:o(h)}])},[e("div",$s,[s[16]||(s[16]=e("h3",null,"已上传数据集",-1)),e("button",{class:"refresh-btn",onClick:x,disabled:w.value},[(d(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:k({spinning:w.value})},s[14]||(s[14]=[e("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"},null,-1)]),2)),s[15]||(s[15]=b(" 刷新 "))],8,Vs)]),w.value?(d(),u("div",Rs,s[17]||(s[17]=[e("div",{class:"loading-spinner"},null,-1),e("span",null,"加载中...",-1)]))):g.value.length===0?(d(),u("div",Hs,s[18]||(s[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"})],-1),e("p",null,"暂无已上传的数据集",-1)]))):(d(),u("div",Os,[(d(!0),u(os,null,ls(g.value,a=>(d(),u("div",{key:a.id,class:"dataset-list-item"},[s[21]||(s[21]=e("div",{class:"dataset-icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h8l6-6V8l-6-6H6zm7 7V3.5L18.5 9H13z"})])],-1)),e("div",js,[e("div",As,c(a.name),1),e("div",Es,[e("span",Zs,c($(a.size)),1),e("span",Ps,c(new Date(a.uploadTime).toLocaleDateString()),1),e("span",Gs,c(a.type),1)])]),e("div",Ks,[e("button",{class:"action-btn download-btn",onClick:n=>G(a.id,a.name),title:"下载"},s[19]||(s[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"})],-1)]),8,Ws),e("button",{class:"action-btn delete-btn",onClick:n=>J(a.id,a.name),title:"删除"},s[20]||(s[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1)]),8,qs)])]))),128))]))],2)):(d(),u("div",{key:2,class:k(["card default-dataset-card",{dark:o(h)}])},[s[24]||(s[24]=e("div",{class:"card-header"},[e("h3",null,"默认数据集")],-1)),e("div",Js,[e("div",{class:"dataset-item",onClick:s[5]||(s[5]=()=>F({name:"MNIST",description:"MNIST 是一个手写数字的图像数据集，包含60000个训练样本和10000个测试样本。",samples:"60,000",format:"28x28 灰度图像",applications:"手写数字识别, OCR技术开发, 机器学习入门教学",imageUrl:"https://upload.wikimedia.org/wikipedia/commons/2/27/MnistExamples.png"}))},s[22]||(s[22]=[e("h4",null,"MNIST 数据集",-1),e("p",null,"MNIST 是一个手写数字的图像数据集，常用于图像分类任务。",-1)])),e("div",{class:"dataset-item",onClick:s[6]||(s[6]=()=>F({name:"CIFAR-10",description:"CIFAR-10 是一个包含10个类别的彩色图像数据集，每个类别有6000张图像。",samples:"60,000",format:"32x32 RGB图像",applications:"图像分类, 物体识别, 深度学习模型训练",imageUrl:"https://complex-valued-neural-networks.readthedocs.io/en/latest/_images/code_examples_cifar10_6_0.png"}))},s[23]||(s[23]=[e("h4",null,"CIFAR-10 数据集",-1),e("p",null,"CIFAR-10 是一个包含10个类别的彩色图像数据集，常用于图像识别任务。",-1)]))])],2)),r(ws,{ref_key:"datasetDrawer",ref:M,dataset:T.value},null,8,["dataset"])])]))}},ae=E(Qs,[["__scopeId","data-v-391e00fe"]]);export{ae as default};
